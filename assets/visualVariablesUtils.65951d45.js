var g=Object.defineProperty;var u=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var c=(e,s,t)=>s in e?g(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,p=(e,s)=>{for(var t in s||(s={}))S.call(s,t)&&c(e,t,s[t]);if(u)for(var t of u(s))$.call(s,t)&&c(e,t,s[t]);return e};import{bQ as y,w as E,W as x}from"./vendor.c414a8c9.js";import{l as r,p as V}from"./Utils.d29fb889.js";import{a9 as _}from"./enums.6e42a319.js";import{o as w}from"./visualVariablesUtils.f6ff214d.js";const A=8388607,h=8388608,I=254,M=255,k=0,z=1,d=e=>(e&h)>>>23,N=e=>e&A,O=e=>d(e)===z?I:M;function P(e){return d(e)===z}function q(e,s){return((s?h:0)|e)>>>0}const B=(e,s)=>e&&((...t)=>s.warn("DEBUG:",...t))||(()=>null),C=!1;function G(e,s){if(!e||!s)return e;switch(s){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function b(e){return{value:e.value,size:y(e.size)}}function a(e){return e.map(s=>b(s))}function f(e){if(typeof e=="string"||typeof e=="number")return y(e);const s=e;return{type:"size",expression:s.expression,stops:a(s.stops)}}const v=e=>{const s=[],t=[],n=a(e),o=n.length;for(let i=0;i<6;i++){const l=n[Math.min(i,o-1)];s.push(l.value),t.push(l.size==null?_:x(l.size))}return{values:new Float32Array(s),sizes:new Float32Array(t)}};function Q(e){const s=e&&e.length>0?{}:null,t=s?{}:null;if(!s)return{vvFields:s,vvRanges:t};for(const n of e)if(n.field&&(s[n.type]=n.field),n.type==="size"){t.size||(t.size={});const o=n;switch(w(o)){case r.SIZE_MINMAX_VALUE:t.size.minMaxValue={minDataValue:o.minDataValue,maxDataValue:o.maxDataValue,minSize:f(o.minSize),maxSize:f(o.maxSize)};break;case r.SIZE_SCALE_STOPS:t.size.scaleStops={stops:a(o.stops)};break;case r.SIZE_FIELD_STOPS:if(o.levels){const i={};for(const l in o.levels)i[l]=v(o.levels[l]);t.size.fieldStops={type:"level-dependent",levels:i}}else t.size.fieldStops=p({type:"static"},v(o.stops));break;case r.SIZE_UNIT_VALUE:t.size.unitValue={unit:o.valueUnit,valueRepresentation:o.valueRepresentation}}}else if(n.type==="color")t.color=F(n);else if(n.type==="opacity")t.opacity=D(n);else if(n.type==="rotation"){const o=n;t.rotation={type:o.rotationType}}return{vvFields:s,vvRanges:t}}function D(e){const s={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(typeof e.field=="string"){if(!e.stops)return null;{if(e.stops.length>8)return null;const t=e.stops;for(let n=0;n<8;++n){const o=t[Math.min(n,t.length-1)];s.values[n]=o.value,s.opacities[n]=o.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const t=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(let n=0;n<8;n++)s.values[n]=1/0,s.opacities[n]=t}}return s}function m(e,s,t){e[4*s+0]=t.r/255,e[4*s+1]=t.g/255,e[4*s+2]=t.b/255,e[4*s+3]=t.a}function F(e){if(E(e)||e.normalizationField)return null;const s={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if(typeof e.field=="string"){if(!e.stops)return null;{if(e.stops.length>8)return null;s.field=e.field;const t=e.stops;for(let n=0;n<8;++n){const o=t[Math.min(n,t.length-1)];s.values[n]=o.value,m(s.colors,n,o.color)}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const t=e.stops&&e.stops.length>=0&&e.stops[0].color;for(let n=0;n<8;n++)s.values[n]=1/0,m(s.colors,n,t)}}for(let t=0;t<32;t+=4)V(s.colors,t,!0);return s}export{A as a,z as c,d as e,N as f,O as i,C as l,Q as m,B as n,P as p,G as r,q as s,k as u};
